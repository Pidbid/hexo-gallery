<div class="container hexo-apple-gallery" id="<%= galleryId %>" style="background-color: <%= background %>; color: <%= titlecolor %>;">
    <!-- [核心修改] 只有在至少存在一个元数据或标题时，才渲染整个信息区域 -->
    <% if ((typeof title !== 'undefined' && title) || (typeof author !== 'undefined' && author) || (typeof site !== 'undefined' && site) || (typeof date !== 'undefined' && date) || (typeof platform !== 'undefined' && platform)) { %>
    <div class="gallery-info">
        <% if (typeof title !== 'undefined' && title) { %><h1 class="gallery-title"><%= title %></h1><% } %>
        
        <!-- [核心修改] 只有在至少存在一个元数据时，才渲染 meta-data 容器 -->
        <% if ((typeof author !== 'undefined' && author) || (typeof site !== 'undefined' && site) || (typeof date !== 'undefined' && date) || (typeof platform !== 'undefined' && platform)) { %>
        <div class="meta-data" style="color: <%= desccolor %>;">
            <% if (typeof author !== 'undefined' && author) { %><div class="meta-item">作者: <%= author %></div><% } %>
            <% if (typeof site !== 'undefined' && site) { %><div class="meta-item">地点: <%= site %></div><% } %>
            <% if (typeof date !== 'undefined' && date) { %><div class="meta-item">日期: <%= date %></div><% } %>
            <% if (typeof platform !== 'undefined' && platform) { %><div class="meta-item">设备: <%= platform %></div><% } %>
        </div>
        <% } %>
    </div>
    <% } %>
    
    <!-- 瀑布流图片区域 -->
    <div class="masonry-gallery" style="column-count: <%= col %>;">
        <% if (images && images.length > 0) { %>
            <% images.forEach(function(imageUrl, index) { %>
                <div class="gallery-item">
                    <a href="<%= imageUrl %>" target="_blank" rel="noopener noreferrer" class="gallery-link">
                        <img src="<%= imageUrl %>" alt="Gallery image <%= index + 1 %>" class="gallery-image" loading="lazy">
                    </a>
                </div>
            <% }); %>
        <% } else { %>
            <p class="gallery-empty-message" style="color: <%= desccolor %>;">未提供任何图片。</p>
        <% } %>
    </div>
</div>
